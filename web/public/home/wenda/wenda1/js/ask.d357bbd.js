;/*!new:widget/aside/aside.js*/
define("new:widget/aside/aside",function(t){var e=t("common:widget/js/util/tangram/tangram"),a=t("common:widget/js/util/template/template"),m=F.context("fixTeamName");"team"==F.context("fixType")&&e.get("/team/api/teaminfo?teamname="+m+"&json=1",function(t){if(t){var t=e.json.parse(t);e(".wgt-aside").html(a("t:fix-team",t)),e(".wgt-title-area .fix-team-name").html(m).attr("href","/team/view/"+m)}})});
;/*!new:widget/js/string/string.js*/
define("new:widget/js/string/string",function(t,r,n){var e=t("common:widget/js/util/tangram/tangram");n.exports={trim:function(t){var r=e(t).length?e(t).val():e("#"+t).val();return r=r.replace(/\n/g," ").replace(/\s+/g," "),r=e.string(r).trim()},getLength:function(t){var r=this.trim(t);return e.string(r).getByteLength()},sense:function(t){var r=this.trim(t);if(/^(\w|\s)+$/.test(r)){if(/^\d+$/.test(r))return!0;var n=r.split(/\s/),e=n.length-1;if(2>=e)return!0;for(var i=e%2==0?e/2+1:(e+1)/2,g=0,s=0;e+1>s;s++)if(n[s].length>5&&(g++,g>=i))return!0}}}});
;/*!new:widget/js/editor/editor.js*/
define("new:widget/js/editor/editor",function(t,e,i){var n=t("common:widget/js/util/tangram/tangram"),r=t("common:widget/js/util/store/store"),s={escapeHtml:function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")},getContentTxt:function(){var t=n("#content-area").val();return this.escapeHtml(t)},getContent:function(){var t="",e=this.getContentTxt();e=n.trim(e),e&&(t+="<p>"+e+"</p>");var i=this.getImgList();return i.length&&(t+='<p><img src="'+i.join('" /></p><p><img src="')+'" /></p>'),t},setContent:function(t){n("#content-area").val(t),t&&!n(".supply-qd-btn").hasClass("on-sup-show")&&n(".supply-qd-btn").trigger("click")},hasImg:function(){return n("#qd-img-list").find("li").length?1:0},filterTag:function(t){return t},setImgList:function(t,e){switch(this.imgList=this.imgList||[],e=e||{},t){case"add":e.url&&this.imgList.push(e.url);break;case"remove":"number"==typeof e.index&&this.imgList.splice(e.index,1);break;case"set":"array"===n.type(e)&&(this.imgList=e)}return r.set("ik_new_askimg",this.imgList.join()),this.imgList},getImgList:function(){return this.imgList||[]},getTitle:function(){var t=n("#title-area").val();return t=n.trim(t),this.escapeHtml(t)},getTagList:function(){var t=[],e=n("#tag-info").find(".tag-list").find(".selected");return n.each(e,function(e,i){t.push(n(i).text())}),t},getSelectedMavin:function(){var t=n(".mavin-list-selector").find("li.on-select");if(!t.length||!n('.cb-status-on[data-id="mavin"]').length)return[];var e=[];return t.each(function(t,i){e.push(n(i).data("uid"))}),e},getFixUid:function(){var t=this.getSelectedMavin();return t.join()}};window.$$editor=s,i.exports=s});
;/*!new:widget/js/authcode/authcode.js*/
define("new:widget/js/authcode/authcode",function(e,t,o){var n,c=e("common:widget/js/util/tangram/tangram"),a=e("common:widget/js/logic/authcode/authcode");o.exports.init=function(e){n||(e=c.object.extend({container:"#ik-authcode-outer",from:"new_post"},e),o.exports.authcode=n=new a(e))},o.exports.authcode=n,o.exports.reset=function(e){e=c.object.extend({container:"#ik-authcode-outer",from:"new_post"},e),n&&n.dispose(),o.exports.authcode=n=new a(e)}});
;/*!new:widget/js/log/log.js*/
define("new:widget/js/log/log",function(e,n,o){var t=e("common:widget/js/util/tangram/tangram"),g=e("common:widget/js/util/log/log"),i={lookBtnClick:0,pushType:10,errorType:1,send:function(e){g.send(t.object.extend({type:80425,mani:1,new20perTest:F.context("new20perTest")},e))},log:function(e){g.log(e)}};o.exports=i});
;/*!new:widget/js/pgc/pgc.js*/
define("new:widget/js/pgc/pgc",function(e,c,t){var i=e("common:widget/js/util/tangram/tangram"),o=e("common:widget/js/util/event/event"),n=e("common:widget/lib/juicer/juicer"),a=e("new:widget/js/authcode/authcode"),p=e("new:widget/js/log/log"),l=i.createClass(function(){var e=this;e.acDelay=null,e.pushDelay=null,e.pgcCid1=0,e.pgcCid2=0,e.pgcProv=0,e.pgcCidMap=F.context("pgcCid"),e.pgcShow=!1,e.ready=function(c,t){if(!F.context("fixType")){if(c&&c.isFromMedical){var i=c[0];e.cancel(),e.pgcCid1=i.cid1,e.pgcCid2=i.cid2,o.fire("pgc.get",i),e.doctorShow=!0}else t&&c?(e.cancel(),e.pushDelay=setTimeout(function(){e.pgcCid1=t.cid1,e.pgcCid2=t.cid2,e.pgcProv=t.prov,o.fire("pgc.get",t)},500)):e.pgcCidMap&&e.pgcCidMap[c]?(e.cancel(),e.acDelay=setTimeout(function(){e.pgcCid1=12,e.pgcCid2=e.pgcCidMap[c],o.fire("pgc.get",{})},500)):e.cancelAC();setTimeout(function(){e.pushDelay||e.acDelay||e.doctorShow||!e.pgcShow||o.fire("pgc.remove",{})},1e3)}},e.cancel=function(){clearTimeout(e.acDelay),clearTimeout(e.pushDelay),e.acDelay=null,e.pushDelay=null},e.cancelAC=function(){clearTimeout(e.acDelay),e.acDelay=null},e.cancelPush=function(){clearTimeout(e.pushDelay),e.pushDelay=null},e.checkAge=function(){var e=i.string(i("#prof_age").val()).trim(),c=parseInt(e);return!e||isNaN(e)||0>c||c>150?!1:!0},e.check=function(){return e.checkForDoctor()},e.checkForDoctor=function(){return e.checkAge()?(i(".pgc-select-main").removeClass("error"),i(".pgc-select-error").hide(),!0):(i(".pgc-select-main").addClass("error"),i(".pgc-select-error").show(),!1)},o.on("pgc.get",function(c,t){({rn:8,cid:e.pgcCid1});i.ajax({url:"//muzhi.baidu.com/doctor/openapi/topndoctor?t="+(new Date).getTime()+"&rn=8&cid="+e.pgcCid1,dataType:"jsonp",success:function(c){if(c){var o=c.data;if(o&&o.doctor_list&&o.doctor_list.length){p.send({new_ui_pgc_push_show:1,cid1:e.pgcCid1});var l,r;l=i("#tpl-push-pgc").html(),r={cid1:t.cid1,title:"医生",total:o.doctor_total,cname:o.class_info.cname,list:o.doctor_list},i(".wgt-push-pgc").empty().html(n(l,r)),i("#pgc-btn").text("免费向医生提问"),e.pgcShow||(i(".wgt-normal-push").hide(),i(".wgt-push-pgc").slideDown(),i("#normail-submit-panel").hide(),i("#pgc-submit-panel").show(),a.reset({container:"#pgc-submit-panel"}),e.pgcShow=!0),i(".tag-guide")&&i(".tag-guide").hide()}}}})}),o.on("pgc.remove",function(){i(".wgt-push-pgc").hide(),i(".wgt-normal-push").show(),i("#pgc-submit-panel").hide(),i("#normail-submit-panel").show(),a.reset({container:"#ik-authcode-outer"}),e.pgcShow=!1})});t.exports=new l});
;/*!new:widget/js/tag/tag.js*/
define("new:widget/js/tag/tag",function(t,e,a){var i=t("common:widget/js/util/tangram/tangram"),n=t("common:widget/js/util/event/event"),s=(t("new:widget/js/string/string"),t("common:widget/js/ui/dialog/dialog")),c=t("new:widget/js/log/log"),o=(t("new:widget/js/editor/editor"),function(){var t=this;t.$titleTagContainer=i(".tag-container").find(".tag-list"),t.$search=i(".tag-container").find(".tag-search"),t.init=function(){t._bindEvents()},t._bindEvents=function(){t.$titleTagContainer.on("click",".tag-item",function(){c.send({page:"ask",type:80425,module:"ask-sample",action:"click",area:"click-tag"})}),t.$search.click(function(){c.send({page:"ask",type:80425,module:"ask-sample",action:"click",area:"add-tag"}),!t._checkTag(1);var e=[];i.each(i("#tag-info").find(".tag-list").find(".selected"),function(t,a){var n=i(a).text();e.push('<span class="tag-item search-tag selected"><i class="i-del"></i>'+n+"</span>")});{var a=['<div class="selected-title f-pening" ',e.length?"":' style="display:none"',"><em>当前标签</em></div>",'<div class="selected-search-tag line">',e.join(""),"</div>",'<div class="selected-title f-pening">更多标签</div> ','<div class="line more-tags">','<div class="tag-input line">','<input type="text" placeholder="在此输入兴趣关键词" class="tag-input-ser" />',"</div>","</div>",'<p class="red-tips ff-arial"></p>','<div class="dialog-tags-wp item-checked">','<i class="ope-arrow-down"><em></em></i>','<div class="dialog-tags line more-tags-container">',"</div>","</div>",'<div class="dialog-tags-wp mt-15 ui-dialog-buttonset clearfix">','<a href="javascript:void(0)" class="btn-32-green saveTo">保存</a>','<a href="javascript:void(0)" class="btn-32-white cancel">取消</a>',"</div>",'<div class="search-tag-list"></div>'];new s({width:556,height:420,title:"编辑标签",content:a.join(""),className:"dialog-tag",autoDispose:!0,open:function(){i(".dialog-tag").on("keyup",".tag-input-ser",function(t){return t.preventDefault(),""===i(".tag-input input").val()?(i(".tag-input input").css("border-color","#f93535").focus(),i(".more-tags-container").empty().hide(),i(".dialog-tags-wp .ope-arrow-down").hide(),void i(".dialog-tags-wp .tag-input-ser").val("")):(i(".tag-input input").css("border-color","#4aca6d"),void i.ajax({type:"POST",url:"/api/gettag",async:!1,data:{type:1,wd:i(".tag-input input").val()},success:function(t){var e=[];if(t=i.json.parse(t),t.data.length>0){for(var a=t.data.length>5?5:t.data.length,n=0;a>n;n++)e.push('<a class="tag-item" data-type=""><span>'+t.data[n].tagname+"</span></a>");i(".more-tags-container").empty().append(e.join("")).show(),i(".dialog-tags-wp .ope-arrow-down").show()}else i(".more-tags-container").html('<div class="no-tags-tip">没有找到相关标签</div>').show(),i(".dialog-tags-wp .ope-arrow-down").show()}}))}).on("blur",".tag-input-ser",function(){t.tagHideTimer=setTimeout(function(){i(".more-tags-container").empty().hide(),i(".dialog-tags-wp .ope-arrow-down").hide(),i(".dialog-tags-wp .tag-input-ser").val("")},1e3)}).on("click",".item-checked .tag-item",function(){var t=i(this),e=i(".selected-search-tag").find(".tag-item").length;if(e>=3)return i(".red-tips").text("问题标签不能超过三个!").show(),void setTimeout(function(){i(".red-tips").hide()},3e3);var a=!0;return i(".selected-search-tag .tag-item").each(function(e,n){i.trim(i(n).text())==i.trim(t.text())&&(a=!1)}),a?(i(".selected-search-tag").append('<span class="tag-item search-tag selected"><i class="i-del"></i><span>'+t.text()+"</span></span>"),i(this).hasClass("tags")?t.parent().addClass("checked"):t.addClass("active"),i(".more-tags-container").empty().hide(),i(".dialog-tags-wp .ope-arrow-down").hide(),void i(".dialog-tags-wp .tag-input-ser").val("")):(i(".red-tips").text("不可重复添加!").show(),void setTimeout(function(){i(".red-tips").hide()},3e3))}).on("click",".saveTo",function(){t.$titleTagContainer.find(".search-tag:not(.selected)").remove();var e=i(".selected-search-tag").find(".selected");i("#tag-info").find(".tag-list").html(e),i(".add-tag-handler").find(".tag-search").text(e.length>=3?"修改":"添加标签"),e.length&&n.fire("mavin.getList"),s.close()}).on("click",".cancel",function(){s.close()}),t.$searchTagContainer=i(".dialog-tag").find(".search-tag-list"),t.$searchTagHolder=i(".dialog-tag").find(".selected-search-tag"),t.$seachInput=i(".dialog-tag").find(".search-tag-input"),t.$searchTagContainer.on("click",".tag-item",function(){t._checkTag(2)&&t._isSelectedTag(i(this).text())&&(i(this).addClass("selected").appendTo(t.$searchTagHolder),i(".selected-title").show())}),t.$searchTagHolder.on("click",".i-del",function(){var t=i(this).parent();t.remove()})}})}})},t._checkTag=function(){var e=t.$titleTagContainer.find(".selected").length,a=i(".dialog-tag").find(".selected-search-tag").find(".selected").length;return 3>e&&3>a},t._isSelectedTag=function(e){var a=!0;return i.each(t.$titleTagContainer.find(".selected"),function(t,n){e==i.trim(i(n).text())&&(a=!1)}),(t.$searchTagHolder=i(".dialog-tag").find(".selected-search-tag"))&&i.each(t.$searchTagHolder.find(".selected"),function(t,n){e==i.trim(i(n).text())&&(a=!1)}),a},t.onTitleSuccessCallback=function(e){var a=[],n=0;for(n;n<e.length;n++){var s=i.trim(e[n].tagname);(0===n||1===n||2===n)&&a.push('<span class="tag-item title-tag selected">'+s+"</span>")}t.$titleTagContainer.html(a.join("")),i("#tag-info").find(".tag-search").text(t.$titleTagContainer.find(".tag-item").length>=3?"修改":"添加标签")},t.onSearchSuccessCallback=function(e){var a=[],n=0,s=[];if(i(".selected-search-tag").find(".tag-item").each(function(t,e){s.push(i(e).text())}),0==e.length)a.push('<div class="no-tags-tip">抱歉，没有为您找到合适的标签。</div>');else for(n;n<e.length;n++){var c=i.trim(e[n].tagname);~s.indexOf(c)||a.push('<span class="tag-item search-tag">'+c+"</span>")}t.$searchTagContainer.html(a.join(""))},n.on("tag.send",function(t,e){var a={};a=0==e.type?{type:e.type,title:e.title,content:e.content,has_pic:e.has_pic}:{type:e.type,wd:e.wd},i.ajax({type:"post",url:"/api/gettag",data:a,cache:!1,success:function(t){if(t=i.json.parse(t),0==t.errno){var a=t.data;e.onSuccessCallback(a)}}})})});a.exports=new o});
;/*!new:widget/js/ac/ac.js*/
define("new:widget/js/ac/ac",function(t,e,a){function n(){var t=this;t.titleArea=i("#title-area"),t.categoryBar=i("#category-bar"),t.lastAcTitle="",t.lastAcDetail="",t.acDelay="",t.data=[],t.finalCid=0,t.finalCname="",t.userSelect=0,t.isUnsupportSet=0,t.checkTitle=function(){var e=c.trim(t.titleArea);return t.lastAcTitle!==e&&e!==t.titleArea.attr("placeholder")?(t.lastAcTitle=e,!0):!1},t.checkDetail=function(){var e=i.string(o.getContentTxt()).trim();return t.lastAcDetail!==e?(t.lastAcDetail=e,!0):!1},t.ready=function(){t.cancel(),t.acDelay=setTimeout(function(){if(t.checkTitle()||t.checkDetail()&&i.string(o.getContentTxt()).trim().length<1499){r.fire("strategy.route");var e={type:0,title:encodeURIComponent(c.trim(t.titleArea)),content:encodeURIComponent(i.string(o.getContentTxt()).trim()),onSuccessCallback:l.onTitleSuccessCallback};e.has_pic=o.hasImg()?1:0,r.fire("tag.send",e)}},1e3)},t.cancel=function(){clearTimeout(t.acDelay)},t.appendCname=function(e,a,n){for(var i="",c=0;c<a.length;c++)i+=c===a.length-1?"<span>"+a[c]+"</span>":a[c]+"  &gt;  ";t.categoryBar.html(i),t.categoryBar.attr("cid",e),"1"!==u.context("psAskFlag")&&n&&s.ready(t.data)};var e={success:function(e){if(t.data=e,!t.userSelect&&!t.isUnsupportSet){t.finalCid=e[0].cid;var a=String(e[0].Title).split("->");t.appendCname(t.finalCid,a,e.isFromMedical)}t.lastAcTitle=c.trim(t.titleArea),t.lastAcDetail=i.string(o.getContentTxt()).trim()},failure:function(){r.fire("pgc.remove",{})}};r.on("ac.send",function(a,n){i.object.extend(e,n);var r="word="+encodeURIComponent(c.trim(t.titleArea))+"&co="+encodeURIComponent(i.string(o.getContentTxt()).trim());i.post("/api/autoclassify",r,function(t){var a=i.json.parse(t);return a.length>0?e.success(a):e.failure(a),e.callback&&e.callback(),e.zybcallback&&e.zybcallback(a),!0},"html")}),r.on("doctor.send",function(a,n){i.object.extend(e,n);var r="title="+encodeURIComponent(c.trim(t.titleArea))+"&content="+encodeURIComponent(i.string(o.getContentTxt()).trim());i.ajax({url:"//muzhi.baidu.com/doctor/openapi/questionclassify?t="+(new Date).getTime()+"&"+r,dataType:"jsonp",success:function(t){if(!t||0!==t.errno)return 1;var a=[t.data];return a.isFromMedical=!0,e.callback&&e.callback(),!0}})}),t.specialDisplay=function(){u.context("doctor-show",0),T("#submit-btn").data("sub")||r.fire("mavin.getList"),i(".offer-reward").show(),i('[data-show="doctor"]').hide(),i("#submit-btn").text("提交").removeClass("pgc-submit-btn")},t.specialDisplayForDoctor=function(){u.context("doctor-show",1),i('[data-show="doctor"]').show(),i("#submit-btn").text("向用户提问").addClass("pgc-submit-btn");var t={type:2071,action:"doctor-show",from_id:1562,area:"doctor-pv",source:"zhidao-change"};d.send(t)},r.on("strategy.route",function(){r.fire("ac.send",{failure:function(){t.ready()},zybcallback:function(e){t.specialDisplay(!i("#submit-btn").data("force")&&e&&e.length>0&&-1!==e[0].Title.indexOf("医疗健康")?!1:!1)}})})}var i=t("common:widget/js/util/tangram/tangram"),c=t("new:widget/js/string/string"),o=t("new:widget/js/editor/editor"),r=t("common:widget/js/util/event/event"),s=t("new:widget/js/pgc/pgc"),l=t("new:widget/js/tag/tag"),d=t("new:widget/js/log/log"),u=window.F;a.exports=new n});
;/*!new:widget/js/category/category.js*/
define("new:widget/js/category/category",function(e,o,a){var t=e("common:widget/js/util/tangram/tangram"),i=e("common:widget/js/util/event/event"),n=e("common:widget/js/ui/dialog/dialog"),c=e("common:widget/js/logic/category/category"),r=e("new:widget/js/ac/ac"),d=e("new:widget/js/log/log"),s=t.createClass(function(){var e=this;e.selectChoosed=0,e.chooseCid=0,e.chooseCname="",e.categoryBar=t("#category-bar");var o;i.on("category.stop",function(o,a){e.categoryBar.html("<span>"+a.cname+"</span>"),e.categoryBar.attr("cid",a.cid)}),i.on("category.set",function(){if(o)return o.remove(),void(o="");o=t('<div id="category-select"></div>'),o.append('<div class="category-title clearfix"><div class="grid">选择分类</div><span class="grid-r close"></span></div><div id="category-panel"></div>'),o.css({position:"absolute",left:0,top:30,zIndex:20}),o.appendTo("#other-bar"),o.find(".close").on("click",function(){o.remove(),o=""}),o.on("mouseleave",function(){o.remove(),o=""}),d.send({new_ui_category_set:1});var a=new c({target:"#category-panel",selectSize:10,noConfirmBtn:!0,defaultValue:e.categoryBar.attr("cid")||74,onchange:function(){var o=a.getValue();e.chooseCid=o.cid,e.chooseCname=o.arrName,e.selectChoosed=1,r.appendCname(o.cid,o.arrName),r.userSelect=1,r.finalCid=e.chooseCid}})}),i.on("category.dialogset",function(){var o=['<div id="category-dialog">','<div class="category-title mb-10"><strong>请从以下推荐分类中选择合适的分类：</strong></div>','<div id="category-dialog-panel"></div><p>如果您的问题无法归入任何子分类，您可以只选择一级分类</p></div>'];n.alert(o.join(""),{title:"选择分类",width:480,height:450,onaccept:function(){r.appendCname(e.chooseCid,e.chooseCname),r.userSelect=1,r.finalCid=e.chooseCid,i.fire("dialog.close"),d.send({new_ui_category_set:1})}});var a=new c({target:"#category-dialog-panel",selectSize:16,noConfirmBtn:!0,defaultValue:74,onchange:function(){var o=a.getValue();e.chooseCid=o.cid,e.chooseCname=o.arrName,e.selectChoosed=1}})})}).extend({});a.exports=new s});
;/*!new:widget/js/input/input.js*/
define("new:widget/js/input/input",function(require,exports,module){var T=require("common:widget/js/util/tangram/tangram"),ec=require("common:widget/js/util/event/event"),editor=require("new:widget/js/editor/editor"),strTool=require("new:widget/js/string/string"),ac=require("new:widget/js/ac/ac"),Log=require("new:widget/js/log/log"),category=require("new:widget/js/category/category"),$=T,Input=T.createClass(function(){function errorTip(e,r){"show"==e?me.errorTip.html(me.errorInfo[r]||"").show():"hide"==e&&me.errorTip.html("").hide()}var me=this;me.titleArea=T("#title-area"),me.titleCount=T("#title-count"),me.errorTip=T("#title-error-tip"),me.errorInfo={empty:"您尚未输入提问","short":"您的问题过短，请将问题说明清楚",nonsense:"您的提问包含大量无意义字符，请重新提问",islow:"您的提问不够清晰，请将问题说明清楚，网友才能为您解答",isUnsupport:"您的问题过于个性化，网友们可能很难帮上您哦",isUnsupportEmail:"知道已支持文件上传和下载功能，为了您的信息安全，请不要留下您的个人邮箱","long":"您的提问标题超过49个字，请精简或将更多内容输入到问题补充中"},me.lastTitle="",me.lastDetail="",me.lastLowTitle="",me.error=0,me.qualityError=0,me.unsupportError=0,me.isLongerTitle=!1,me.trim=function(e){var r=strTool.trim(e);return r==me.titleArea.attr("placeholder")?"":r},me.getLength=function(e){var r=strTool.trim(e);return r==me.titleArea.attr("placeholder")?0:strTool.getLength(e)},me.sense=function(e){return strTool.sense(e)},ec.on("input.check",function(){var e=me.getLength(me.titleArea);0==e?(errorTip("show","empty"),me.error=1,Log.errorType=2):8>e?(errorTip("show","short"),me.error=1,Log.errorType=3):e>98?(errorTip("show","long"),$(".supply-qd-btn").hasClass("on-sup-show")||$(".supply-qd-btn").trigger("click"),me.error=1,Log.errorType=4):me.sense(me.titleArea)?(errorTip("show","nonsense"),me.error=1,Log.errorType=5):(!me.qualityError&&!me.unsupportError||me.error)&&(me.error=0,errorTip("hide"))}),ec.on("input.sub",function(){var e=me.getLength(me.titleArea),r=me.trim(me.titleArea),t=me.titleCount.find("b");t.html(Math.ceil(e/2)),e>98?(t.addClass("error"),me.isLongerTitle=!0,me.errorTip.html("您的提问标题超过49个字!").show(),ec.fire("input.check")):(t.hasClass("error")&&t.removeClass("error"),me.isLongerTitle=!1),!me.qualityError&&!me.unsupportError||me.error||ec.fire("input.check"),me.error&&ec.fire("input.check"),me.lastTitle=r}),ec.on("input.qualityclear",function(){me.qualityError=0,me.unsupportError=0}),ec.on("input.quality",function(e,obj){obj.islow=function(){errorTip("show","islow"),me.qualityError=1},obj.isUnsupport=function(e){ac.finalCid=e.category.cid,ac.isUnsupportSet=1;for(var r=new String(e.category.title).split("->"),t="",o=0;o<r.length;o++)t+=o==r.length-1?r[o]:r[o]+"  &gt;  ";ec.fire("category.stop",{cname:t,cid:e.category.cid}),errorTip("show",1==e.isUnsupport?"isUnsupportEmail":"isUnsupport"),me.unsupportError=1},clearInterval(window.lowInterval),window.lowInterval=setInterval(function(){var title=me.trim(me.titleArea),detail=T.string(editor.getContentTxt()).trim();if(title==ac.lastAcTitle){clearInterval(window.lowInterval),window.lowInterval=0;var url="/api/titlefilter",search=[];search.push("rn=2"),search.push("word="+encodeURIComponent(title)),search.push("content="+encodeURIComponent(detail)),search.push("ac="+ac.finalCid),search.push("tln="+obj.pushTotal);for(var i=0;i<obj.pushTotal;i++)search.push("tl"+(i+1)+"="+encodeURIComponent(obj.pushData[i]));me.lastLowTitle!=search.join("&")&&T.post(url,search.join("&")+"&t="+(new Date).getTime(),function(req){var data=eval("("+req+")");data.status&&1==data.status&&(1==data.isLow?obj.islow():(errorTip("hide","islow"),me.qualityError=0),data.isUnsupport&&0!=data.isUnsupport?obj.isUnsupport(data):(me.unsupportError=0,ac.isUnsupportSet=0))},"html"),me.lastLowTitle=search.join("&")}},100)})});module.exports=new Input});
;/*!new:widget/js/lbs/lbs.js*/
define("new:widget/js/lbs/lbs",function(i,e,t){var a=i("common:widget/js/util/tangram/tangram"),n=i("new:widget/js/string/string"),l=i("common:widget/js/util/event/event"),s=(i("common:widget/js/ui/dialog/dialog"),a.createClass(function(){var i=this;i.lastTitle="",i.titleArea=a("#title-area"),i.data={},i.lbsDelay="",i.finalAddress="",i.finalStreet="",i.finalDistrict="",i.finalCity="",i.finalProvince="",i.finalBusiness="",i.finalDetail="",i.finalLng="",i.finalLat="",i.userSelect=0,i.userDelete=0,i.flag=0,i.selectType=0,i.checkTitle=function(e){var t=n.trim(e);return t!=i.lastTitle&&t!=i.titleArea.attr("placeholder")?(i.lastTitle=t,!0):!1},i.ready=function(){i.cancel(),i.lbsDelay=setTimeout(function(){i.checkTitle(i.titleArea)&&0==i.userSelect&&l.fire("lbs.send",{callback:function(){}})},1e3)},i.cancel=function(){clearTimeout(i.lbsDelay)};var e={patch:"",conId:"#address-value",hookId:"#title-area",success:function(t){i.data=t;var l=a("#address-info"),s=a(e.conId),o=a("#address-delete"),r=a("#address-label");1!=i.userSelect&&(0==t.status&&0==t.data.status?(i.finalAddress=t.data.name||"",i.finalStreet=t.data.street||"",i.finalDistrict=t.data.district||"",i.finalCity=t.data.city||"",i.finalProvince=t.data.province||"",i.finalBusiness=t.data.business||"",i.finalDetail=t.data.address||t.data.city+t.data.district+t.data.street,i.finalLng=t.data.lng,i.finalLat=t.data.lat,""==i.finalAddress?(l.hide(),r.show(),s.html(i.finalAddress),i.flag=0):(s.html(i.finalAddress),setTimeout(function(){l.show(),r.hide()},500),i.flag=1)):(l.hide(),s.html(""),r.show(),i.flag=0,i.finalAddress=t.ipinfo.ip_name||"",i.finalCity=t.ipinfo.ip_city||"",i.finalProvince=t.ipinfo.ip_province||"",i.finalLng=t.ipinfo.ip_lng,i.finalLat=t.ipinfo.ip_lat)),1==i.userDelete&&(i.flag=0,i.finalAddress=t.ipinfo.ip_name||"",i.finalCity=t.ipinfo.ip_city||"",i.finalProvince=t.ipinfo.ip_province||"",i.finalLng=t.ipinfo.ip_lng,i.finalLat=t.ipinfo.ip_lat),a(o).click(function(e){e.stopPropagation(),l.hide(),s.html(""),r.show(),i.finalAddress="",i.finalStreet="",i.finalDistrict="",i.finalCity="",i.finalProvince="",i.finalBusiness="",i.finalLng="",i.finalLat="",i.userDelete=1,i.userSelect=1}).mouseover(function(){a(this).addClass("i-del-place-hover")}).mouseout(function(){a(this).removeClass("i-del-place-hover")}),i.lastTitle=n.trim(e.hookId)},failure:function(){}};l.on("lbs.send",function(i,t){a.object.extend(e,t);var l="pc=1&title="+encodeURIComponent(n.trim("title-area"));a.post("/api/getgpsinfo",l,function(i){var i=a.json.parse(i);return e.success(i),e.callback&&e.callback(),!0},"html")}),l.on("lbs.submitAddress",function(i,e){t.exports&&(a.object.extend(t.exports,e),a("#address-info").show(),a("#address-label").hide(),l.fire("dialog.close"))}),l.on("lbs.getCurAddress",function(i,e){e.finalProvince=t.exports.finalProvince,e.finalAddress=t.exports.finalAddress})}));t.exports=new s});
;/*!new:widget/js/page/ask.js*/
define("new:widget/js/page/ask",function(e){e.async(["common:widget/js/util/tangram/tangram","common:widget/js/util/event/event","new:widget/js/input/input","new:widget/js/ac/ac","new:widget/js/authcode/authcode","new:widget/js/submit/submit","new:widget/js/editor/editor","common:widget/js/util/store/store","common:widget/lib/jquery.placeholder/jquery.placeholder","common:widget/js/util/log/log","new:widget/js/zhima/zhima","common:widget/js/util/https/https","new:widget/js/string/string"],function(t,i,n,a,s,o,r,c,l,g,d,u,m){var p=t;t(function(){if("ps"==F.context("fr")&&/.baidu.com/.test(document.referrer)){var n=t.string(decodeURIComponent(t.url.getQueryValue(location.href,"title"))).encodeHTML()||"",o=t.string(decodeURIComponent(t.url.getQueryValue(location.href,"detail"))).encodeHTML()||"";t("#title-area").val(n),""!=o&&r.setContent(o),i.fire("input.sub",{}),s.init(),i.fire("ac.send",{callback:function(){i.fire("input.quality",{pushTotal:0,pushData:[]}),i.fire("submit.submit")},failure:function(){a.ready()}})}else if(F.context("query"))i.fire("input.sub",{}),a.ready();else if(F.context("cid"))e.async(["new:widget/js/category/category"],function(){t("#category-bar").attr("cid",F.context("cid")),i.fire("category.set",{}),t("#category-select").hide()});else{{var l=c.get("ik_new_asktitle"),g=c.get("ik_new_askdetail"),w=c.get("ik_new_askimg");c.get("ik_new_asktitle_settime")||0,c.get("ik_new_askdetail_settime")||0}if(l?(t("#title-area").val(l),i.fire("input.sub",{}),m.getLength(t("#title-area"))>8&&p("#submit-btn").removeClass("disabled"),a.ready()):!F.context("zhimaTagOpen")||!F.context("zhimaTagOpen").open,g){var f=p(".supply-qd-btn");f.hasClass("on-sup-show")||f.trigger("click"),p("#content-area").val(g)}if(w){w=w.split(",");var h=[];p.each(w,function(e,t){h.push('<li style="background-image:url('+u.autoTrans(t)+')"><span class="bg"></span><span class="del-btn">删除</span></li>')}),h=h.join(""),p("#qd-img-list").append(h).fadeIn(),r.setImgList("set",w)}}F.context("zhimaTagOpen")&&F.context("zhimaTagOpen").open&&d.init()})})});
;/*!new:widget/js/pgcselect/pgcselect.js*/
define("new:widget/js/pgcselect/pgcselect",function(e,t,a){var s=e("common:widget/js/util/tangram/tangram"),n=s.createClass(function(e){var t,a,n,i,o,c,d,l=this,r=[],u=null;this.isExpand=!1;var p={id:l.guid,selectId:-1,formName:"",defaulMessage:"请选择",icon:"",className:"pgc-select",rowTemplate:"<li #{className} value='#{optId}' data-name='#{optName}'><a href='#'>#{optName}</a></li>",data:{},isShowIcon:!0,isOption:!1,OptionText:"请选择",isAuto:!1,showCount:0,onChange:function(){}};s.object.extend(p,e),s.object.extend(p.data,e.data),l.config=p,l.target=s(s.isString(p.id)?"#"+p.id:p.id),l.render=function(){t=s("<div/>"),t.addClass(p.className+"-main boxshadow"),n=s("<ul/>"),n.addClass(p.className+"-warp"),n.click(function(e){e.preventDefault(),l.isExpand?l.close():(l.open(),u=l.target.get(0))}),p.isShowIcon&&(a=s("<li/>"),a.addClass(p.className+" "+p.icon),n.append(a)),o=s("<input name='"+p.formName+"' type='hidden'/>"),o.val(p.selectId),i=s("<li class='"+p.className+"-show'><span></span></li>"),i.append(o),l.setTitle(),n.append(i),c=s("<li><span/></li>"),c.addClass(p.className+"-oper  up"),s(document).on("click",function(e){u&&!s(e.target).closest("#"+u.id).get(0)&&(l.isExpand=!0,l.close())}),n.append(o).append(c).appendTo(t),d=s("<ul/>"),d.addClass(p.className+"-content").hide(),d.appendTo(t),13==p.cid?(l.initSlecetContent(),d.delegate("li","click",function(e){s(this).hasClass("not-item")||l.changeArray(s(this).attr("value"),s(this).attr("data-name"),e.type)})):(l.generateContent(),d.delegate("li","click",function(e){e.preventDefault(),l.change(s(this).attr("value"),e.type)})),s('<label class="pgc-select-error">'+p.errMsg+"</label>").appendTo(t),t.appendTo(l.target)},l.initSlecetContent=function(){r=[],s.each(p.data,function(e,t){p.showCount>0&&t.key==p.selectId||r.push(s.string(p.rowTemplate).format({optId:t.key,optName:t.item,className:t.key==p.selectId?"class='current'":-11==t.key?"class='not-item'":""}))}),d.html(r.join(""))},l.generateContent=function(){var e=0;r=[],p.isOption&&(r.push(s.string(p.rowTemplate).format({optId:-1,optName:p.defaulMessage||p.OptionText,className:-1==p.selectId?"class='current'":""})),e++),p.data&&(p.showCount>0&&p.data[p.selectId]&&(r.push(s.string(p.rowTemplate).format({optId:p.selectId,optName:p.data[p.selectId],className:"class='current'"})),e++),s.object.each(p.data,function(e,t){p.showCount>0&&t==p.selectId||r.push(s.string(p.rowTemplate).format({optId:t,optName:e,className:t==p.selectId?"class='current'":""}))}),p.showCount>0&&(r=r.slice(0,p.showCount+e))),d.html(r.join(""))},l.getContent=function(){return d},l.setTitle=function(){i.attr("data-tip",p.defaulMessage),i.find("span").text(p.data[p.selectId]||p.defaulMessage),o.val(p.selectId)},l.changeArray=function(e,t){o.val(e),i.attr("data-tip",p.defaulMessage),i.find("span").first().text(t),d.find("li").removeClass("current"),s(d.find("li")).each(function(t,a){s(a).attr("value")==e&&s(a).addClass("current")}),p.isShowIcon&&(a.removeClass(),a.addClass(p.className+" "+p.icon)),l.close(),p.onChange(e,arguments[1]||"")},l.change=function(e){p.data[e]||(e=-1),o.val(e),i.attr("data-tip",p.defaulMessage),i.find("span").first().text(p.data[e]||p.defaulMessage),d.find("li").removeClass("current"),s(d.find("li")).each(function(t,a){s(a).attr("value")==e&&s(a).addClass("current")}),p.isShowIcon&&(a.removeClass(),a.addClass(p.className+" "+p.icon)),l.close(),p.onChange(e,arguments[1]||"")},l.close=function(){l.isExpand=!1,d.hide(),c.removeClass("down").addClass("up"),p.isAuto&&t.width(l.width)},l.open=function(){l.isExpand=!0,d.show(),c.removeClass("up").addClass("down"),p.isAuto&&(l.width=t.width(),t.width(d.width())),t.removeClass("auth-error")},l.render(),l.change(p.selectId),l.target.on("foucs",function(){t.addClass("focus")})}).extend({getContainer:function(){return this.target},show:function(){this.target.show()},hide:function(){this.target.hide()},refresh:function(e){var t=this.config;s.object.extend(t,e),s.object.extend(t.data,e.data),13==e.cid?(this.initSlecetContent(),this.changeArray(t.selectId,"问题类型")):(this.generateContent(),this.change(t.selectId))}});a.exports=n});
;/*!new:widget/js/phone/phone.js*/
define("new:widget/js/phone/phone",function(e,n,o){var i=e("common:widget/js/util/tangram/tangram"),t=e("common:widget/js/logic/phone-bind/phone-bind"),s=e("common:widget/js/util/event/event"),c=(e("common:widget/js/ui/dialog/dialog"),e("new:widget/js/log/log"),i.createClass(function(){var e=this;e.isSelect=0,e.isBind=0,e.noLogin=!1,s.on("phone.bind",function(e,n){var o=F.context("user").securemobil,i=F.context("user").bindmobileToken,s=F.context("user").rebindmobileToken,c=""==o?"bindmobile":"rebindmobile",b=""==o?i:s,d=new t;d.bindPassMobile({action:c,token:b,title:"绑定手机号",msg:'<b class="title-tip">收到答案时，我们将发送免费短信通知您</b>',color:"green",submitText:n.submitText,onRender:n.onRender,onBeforeSuccess:n.onBeforeSuccess,onSubmitSuccess:n.onSubmitSuccess})})}));o.exports=new c});
;/*!new:widget/js/wealth/wealth.js*/
define("new:widget/js/wealth/wealth",function(t,a,n){var e=t("common:widget/js/util/tangram/tangram"),s=t("common:widget/js/ui/dialog/dialog"),i=(t("common:widget/js/util/event/event"),t("common:widget/js/util/log/log")),o=(t("common:widget/js/logic/submit/submit"),t("common:widget/js/logic/login/login"),e),l=e.createClass(function(){var t=this;t.noLoginSubmit=!1,t.checkWealth=function(){var a=F.context("wealth"),n=F.context("isFetchWealth"),l=e(".cb-status-on[data-id=reward]").length?o("#question-description").find(".reward-num").text():0,c=e(".cb-status-on[data-id=anonymity]").length?0:0,h=0;if(h>a-l-c){var p=[];p.push('<div class="dialog-wealth"><div class="dialog-wealth-title">'),p.push("<p>"),c>0&&p.push("匿名提问消耗<span>"+c+"</span>财富值"),l>0&&p.push(c>0?"，您为提问悬赏了<span>"+l+"</span>财富值":"您为提问悬赏了<span>"+l+"</span>财富值"),p.push("</p><p>您当前拥有<span>"+a+"</span>财富值，不足以支付</p>"),p.push('<h2 class="f-yahei">请您在获取财富值后再进行提问</h2></div><div class="dialog-wealth-info">'),p.push("<p>您可以选择以下方式获取财富值：</p>"),n||p.push('<p>1、<a class="get-wealth-btn" href="javascript:void(0);">领取补助财富值<span>10</span>(限领一次)</a></p>'),p.push("<p>"+(n?1:2)+'、<a target="_blank" class="f-simsun" href="/ihome/ask">处理之前提问>></a></p>'),p.push("<p>"+(n?2:3)+'、<a target="_blank" class="f-simsun" href="http://www.baidu.com/search/zhidao_help.html?nav=1#知道积分">查看其它获取财富值方式>></a></p>'),p.push("</div></div>");var r=s.alert(p.join(""),{titleText:"财富值不足提示",width:454,height:356,open:function(){i.addKey({userWealth:a})},onaccept:function(){return t.noLoginSubmit&&window.location.reload(!0),!0}}),u=r.instance.dialog("widget");return e(".dialog-wealth-info .get-wealth-btn",u).on("click",function(){var t=this,n=arguments.callee;e.ajax({url:"/submit/user",type:"POST",data:{cm:100508,uflag:"fetch_wealth"},success:function(s){var i=a;s&&"0"==e.json.parse(s).errorNo?(e(t).html("已领取成功 √").off("click",n),e(".dialog-wealth-title p",u).last().html(a-l-c+10>5?"您当前拥有<span>"+(a+10)+"</span>财富值，可继续提问":"您当前拥有<span>"+(a+10)+"</span>财富值，不足以支付"),i=a+10):s&&"10061"==e.json.parse(s).errorNo&&e(t).html("您已经领取过了哦").off("click",n)},error:function(){}})}),!1}return!0}});n.exports=new l});
;/*!new:widget/js/zhima/zhima.js*/
define("new:widget/js/zhima/zhima",function(e,t,a){var n=e("common:widget/lib/jquery/jquery"),r={$titleArea:n("#title-area"),hasTagFlag:!1,init:function(){var e=this;e.doCheck(),e.detectTag(),e.hasTagFlag||e.createTag();var t=function(e){var t,a,n,r,i,o=0,l=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?(o=e.selectionStart,l=e.selectionEnd):(a=document.selection.createRange(),a&&a.parentElement()==e&&(r=e.value.length,t=e.value.replace(/\r\n/g,"\n"),n=e.createTextRange(),n.moveToBookmark(a.getBookmark()),i=e.createTextRange(),i.collapse(!1),n.compareEndPoints("StartToEnd",i)>-1?o=l=r:(o=-n.moveStart("character",-r),o+=t.slice(0,o).split("\n").length-1,n.compareEndPoints("EndToEnd",i)>-1?l=r:(l=-n.moveEnd("character",-r),l+=t.slice(0,l).split("\n").length-1)))),{start:o,end:l}};n("#title-area").on("keydown",function(a){var n=t(document.getElementById("title-area")).start;8==a.which&&0==n&&e.hasTagFlag&&(e.deleteTag(),e.doCheck())})},getTagFlag:function(){return this.hasTagFlag},detectTag:function(){var e=this;e.$titleArea.on("keyup",function(){e.doCheck()})},doCheck:function(){var e=this,t=/\#芝麻开门\#/,a=e.$titleArea.val(),n=a.match(t);null!==n&&e.hasTagFlag===!1&&(e.$titleArea.val(a.replace("#芝麻开门#","")),e.createTag())},createTag:function(){var e=this;n('<a href="'+F.context("zhimaTagOpen").url+'?fr=new" class="zhima-tag" target="_blank">'+F.context("zhimaTagOpen").text+"</a>").insertAfter("#title-area"),e.$titleArea.addClass("zhima-title"),n("#title-area-shadow").css("text-indent","87px"),n.browser.ie&&setTimeout(function(){e.$titleArea.blur().focus()},10),e.hasTagFlag=!0},deleteTag:function(){var e=this,t=function(){n(".zhima-tag").remove(),e.$titleArea.removeClass("zhima-title"),n("#title-area-shadow").css("text-indent","0"),n.browser.ie&&setTimeout(function(){e.$titleArea.blur().focus()},10),e.hasTagFlag=!1};t()}};a.exports=r});
;/*!new:widget/js/submit/submit.js*/
define("new:widget/js/submit/submit",function(e,t,n){var i=T=e("common:widget/js/util/tangram/tangram"),o=e("common:widget/js/util/event/event"),a=(e("common:widget/js/logic/login/login"),e("common:widget/js/logic/submit/submit")),s=e("common:widget/js/util/store/store"),c=e("common:widget/js/logic/captcha/captcha"),l=e("new:widget/js/ac/ac"),r=e("new:widget/js/authcode/authcode"),d=e("new:widget/js/input/input"),u=e("new:widget/js/editor/editor"),m=e("new:widget/js/phone/phone"),p=e("new:widget/js/wealth/wealth"),g=(e("new:widget/js/lbs/lbs"),e("new:widget/js/pgc/pgc")),h=e("new:widget/js/log/log"),f=e("new:widget/js/zhima/zhima"),w=(e("new:widget/js/tag/tag"),e("common:widget/js/ui/dialog/dialog"),e("common:widget/lib/juicer/juicer"),T.createClass(function(){function e(e){return 0==l.finalCid&&(l.finalCid=74),w.pgcSubmit&&!g.check()?void(h.errorType=9):void(i("#phone").hasClass("cb-status-on")&&!m.isBind&&"1"!==F.context("psAskFlag")?o.fire("phone.bind",{submitText:'<a href="javascript://" class="no-answer-sms">答案无需通知我>></a>',onRender:function(e){i(".no-answer-sms").click(function(n){n.preventDefault(),e.close(),t()})},onBeforeSuccess:function(e){e.close(),t()}}):t(e))}function t(e){var t={};if(!w.pgcSubmit){var c=T(".cb-status-on[data-id=reward]").length?i("#question-description").find(".reward-num").text():0;t={query:F.context("query"),title:d.lastTitle,detail:u.filterTag(u.getContent()),cid:l.finalCid,isAuto:-l.userSelect,pid:"",wealth:c,anoy:T(".cb-status-on[data-id=anonymity]").length,fix:T("#fix-uname").length?T("#fix-uname").attr("data-user"):"",fr:F.context("fr"),entry:i.url.getQueryValue(location.href,"entry")||"pcAsk",querytype:F.context("queryType"),psquery:F.context("psQuery"),rich:1,autofix:0,sms:i(".cb-status-on[data-id=phone]").length,pushType:h.pushType};var p=[];i.each(i(".widget-tag").find(".tag-list").find(".selected"),function(e,t){p.push(i(t).text())}),0==p.length?(p.push(i(".widget-tag").find(".tag-list").find(".tag-item").first().html()),h.send({type:2014,ac:"submit",pos:"ask_tag",desc:"auto_tag"})):h.send({type:2014,ac:"submit",pos:"ask_tag",desc:"selected_tag"}),t.tags=p.join("_");var _;r.authcode.getCode&&(_=r.authcode.getCode())&&(t.vcode_str=_.vcode_str,t.vcode=_.vcode,_.littleflow&&(t.littleflow="true")),f.getTagFlag()&&F.context("zhimaTagOpen")&&F.context("zhimaTagOpen").open&&(t.hasZhimaTag=1),"1"===F.context("psAskFlag")&&(t.ps_ask_flag=1,"top"===F.context("psAskPos")?t.submit_from="psask_import_top":"bottom"===F.context("psAskPos")&&(t.submit_from="psask_import_bottom")),1==t.sms&&T.get("/api/remindset?flag=mobile&status=on&t="+(new Date).getTime(),function(){},"html");var b=w.guid+"_TARGET";o.on("cmSubmit",function(e,t){function n(e){new a({url:"/submit/ajax",type:"post",syncId:b,params:T.object.extend({cm:"100001"},i),hasJump:!1,beforeJump:function(t,n){if(h.errorType=0,w.pgcSubmit&&h.send({new_ui_pgc_submit_succ:1,cid1:g.pgcCid1}),s.remove("ik_new_asktitle"),s.remove("ik_new_askdetail"),s.remove("ik_new_askimg"),s.remove("ik_new_asktitle_settime"),s.remove("ik_new_askdetail_settime"),o){var a=T.cookie.get("IK_PSASKUNLOGIN_TIMES")||0;a=parseInt(a)+1,T.cookie.set("IK_PSASKUNLOGIN_TIMES",a,{path:"/",expires:7776e6});var c=T.cookie.get("IK_PSASKUNLOGIN_QIDS")||"";""==c?c=n.qid:c+="_"+n.qid,T.cookie.set("IK_PSASKUNLOGIN_QIDS",c,{path:"/",expires:7776e6}),T.cookie.set("IK_PSASKUNLOGIN_TITLE_"+a,n.title,{path:"/",expires:7776e6})}if(m.noLogin){var r=F.context("user").securemobil;F.context("psAskFlag")||(T.cookie.set("IK_NEW_PHONE",r,{path:"/",expires:288e5}),T.cookie.set("IK_SUCCESS_JUMP","100001",{path:"/",expires:288e5}))}if(l.userSelect){var p=function(){for(var e=T("#category-bar").html().trim(),t=e.split("&gt;"),n="",i=0;i<t.length;i++){if(i==t.length-1){n+=t[i].replace("<span>","").replace("</span>","").trim();break}n+=t[i].trim()+"->"}return n},f=encodeURIComponent(d.lastTitle),_=encodeURIComponent(T.string(u.getContentTxt()).trim()),b="",k="",x=l.finalCid,y=encodeURIComponent(p());0!=l.data.length&&(b=l.data[2]?l.data[0].cid+"_"+l.data[1].cid+"_"+l.data[2].cid:l.data[1]?l.data[0].cid+"_"+l.data[1].cid:l.data[0].cid,k=l.data[2]?l.data[0].Title+"__"+l.data[1].Title+"__"+l.data[2].Title:l.data[1]?l.data[0].Title+"__"+l.data[1].Title:l.data[0].Title),k=encodeURIComponent(k),window.UFOcallback=function(){};var v="?product_line=302&extend_qid="+n.qid+"&extend_title="+f+"&extend_content="+_+"&extend_query_type=pc&extend_cid_before="+b+"&extend_cid_before_readable="+k+"&extend_cid_after="+x+"&extend_cid_after_readable="+y,S="http://ufo.baidu.com/listen/api/addfeedback",I=S+v;T.sio(I).callByServer("UFOcallback")}h.send({module:"new",abtest:F.context("sBoxAbtest"),refer:document.referrer,page:"new",evtType:"click",pos:"submit-ok",qid:n.qid,area:"sub-done",mavincnt:i.fix.length?i.fix.split(",").length:0,ismsg:i.sms,wealth:i.wealth,issupply:+!!i.detail,anoy:i.anoy,ncAnalyseCode:e&&e.code}),setTimeout(function(){location.href="/question/"+n.qid+".html"},500)},authcode:t.authcode||r.authcode})}var i=t.params,o=t.params.ps_ask_unlogin||"";window.nccheck?nccheck(function(e){n(e)}):n()}),n(t,e)}}function n(e,t){"1"===F.context("psAskFlag")&&t&&"nologinBtn"==t.btnType?(w.catcha=new c({type:"biknow_new_ask",from:"biknow_new_ask",submitParams:{params:e}}),o.off("catcha.submit"),o.on("catcha.submit",function(t,n){T.extend(e,n.params),e.ps_ask_unlogin=1,o.fire("cmSubmit",{params:e,authcode:w.catcha})})):o.fire("cmSubmit",{params:e})}var w=this;w.submitBtn=T("#submit-btn"),w.submitPanel=T("#submit-panel"),w.lookPanel=T("#look-panel"),w.pgcSubmit=!1,o.on("submit.pushchange",function(e,t){"continue"==t.type?T(".wgt-push").slideDown("500",function(){w.lookPanel.hide(),w.submitPanel.show(),w.submitBtn.next().show();var e=T(".wgt-push .push-title").offset().top-T(top.window).scrollTop()-5||512,t=0,n=(e-t)/18,i=setInterval(function(){t>=e?(clearInterval(i),i=""):(t+=n,window.scrollBy(0,n))},20)}):"look"==t.type?(w.submitPanel.hide(),w.lookPanel.show()):"ask"==t.type&&(w.lookPanel.hide(),w.submitBtn.next().hide(),w.submitPanel.show(),T(".wgt-push").hide(),T(".wgt-push .push-con").empty())}),o.on("submit.submit",function(t,n){return o.fire("input.check"),d.error?(window.scrollTo(0,0),void T("#title-area").get(0).focus()):void("1"===F.context("psAskFlag")&&n&&n.noLoginFlag?(w.psaskNoLoginSubmit=1,e({btnType:"nologinBtn"})):o.fire("login.check",{isLogin:function(){if(T("#user-name").length&&-1!=T("#user-name").html().indexOf("#")){var t="IK_SKIP",n=(T.cookie.get(t)||"").split("|"),i=T.url.escapeSymbol(T("#user-name").html());T.array(n).contains(i)?e():o.fire("login.setUsername",{patch:"click_from=new&skippable=1&username="+i,titleText:"起个好听的用户名吧，否则您的提问将被匿名处理！",onSetSuccess:function(){e()}})}else e()},noLogin:function(){h.errorType=6,o.fire("login.log",{onLoginSuccess:function(t){m.noLogin=!0,p.noLoginSubmit=!0,t.mobile&&(F.context("user").securemobil=t.mobile),F.context("user").stoken=t.stoken,F.context("wealth",t.userWealth),F.context("isFetchWealth",t.isFetchWealth),1===t.isRealName?window.location.reload(!0):e()},patch:"ask",sms:"1"===F.context("psAskFlag")?2:0,psFlag:"1"===F.context("psAskFlag")?1:0})}}))})}));n.exports=new w});
;/*!new:widget/js/push/push.js*/
define("new:widget/js/push/push",function(e,t,n){var i=(e("common:widget/lib/jquery/jquery"),e("common:widget/js/util/tangram/tangram")),o=e("new:widget/js/string/string"),r=e("new:widget/js/editor/editor"),s=e("common:widget/js/util/event/event"),u=(e("common:widget/js/util/template/template"),e("new:widget/js/submit/submit"),e("new:widget/js/input/input"),e("new:widget/js/log/log"),e("new:widget/js/pgc/pgc")),a=i.createClass(function(){var e=this;e.pushDelay="",e.titleArea=i("#title-area"),e.pushTitle="",e.pushContent="",e.pushTotal=0,e.pushData=[],e.hasShowLook=!1,e.hasUploadPic=!1,e.check=function(t){return o.trim(e.titleArea)==e.titleArea.attr("placeholder")?!1:o.getLength(t)>=8&&!o.sense(t)?!0:!1},e.ready=function(){e.cancel(),e.pushDelay=setTimeout(function(){e.check(e.titleArea)&&!e.hasUploadPic&&s.fire("push.get",{})},1e3)},e.cancel=function(){clearTimeout(e.pushDelay)},e.clear=function(){e.cancel(),s.fire("submit.pushchange",{type:"ask"})},e.encodeHTML=function(e){return e.replace(/&lt;font color=&quot;#C60A00&quot;&gt;/g,'<font color="#C60A00">').replace(/&lt;\/font&gt;/g,"</font>").replace(/&lt;br&gt;/g,"<br>")},s.on("push.get",function(){var t=o.trim(e.titleArea),n=r.getContentTxt();(t!=e.pushTitle||n!=e.pushContent)&&(e.pushTitle=t,e.pushContent=n,i(".wgt-push .push-con").empty().hide(),i("#push-loading").show(),i.post("/api/newaskpush",{word:t,content:n},function(t){i("#push-loading").hide();var t=i.json.parse(t);if(!/.baidu.com\/search/.test(document.referrer)&&!/.baidu.com\/question/.test(document.referrer)||o.trim(e.titleArea)!=F.context("query")){return t&&t.pgcInfo?void u.ready(t.pgcInfo.cid1,t.pgcInfo):void u.cancelPush()}},"html"))})});n.exports=new a});
;/*!new:widget/otherbar/otherbar.js*/
define("new:widget/otherbar/otherbar",function(t){var o=t("common:widget/js/util/tangram/tangram"),e=t("common:widget/js/util/event/event"),n=(t("new:widget/js/category/category"),t("new:widget/js/phone/phone")),i=t("common:widget/js/ui/tip/tip"),s=t("new:widget/js/log/log"),a=o("#category-bar"),c=o("#other-bar .category-arrow"),l={init:function(){function t(){e.fire("category.set",{}),s.send({new_ui_category_click:1})}a.on("click",function(){t()}),c.on("click",function(){t()}),this._initPhone(),this._initTip()},_initPhone:function(){if(F.context("user").isLogin){var t=F.context("user"),i=o.cookie.get("IK_NEW_PHONESET");1==i?n.isSelect=0:(n.isSelect=1,0!==o("#phone").length&&(o("#phone").get(0).checked=!0)),t.securemobil&&(n.isBind=1)}else n.isSelect=0;o("#phone").on("click",function(){s.send({module:"new",page:"ask",area:"ask_normal_phone",action:"click"}),this.checked?(n.isSelect=1,o.cookie.remove("IK_NEW_PHONESET",{path:"/"})):(n.isSelect=0,o.cookie.set("IK_NEW_PHONESET","1",{path:"/",expires:2592e6}))}),o("#phone-bar a").on("click",function(){e.fire("phone.bind",{onSubmitSuccess:function(){setTimeout(function(){window.location.reload()},500)}})})},_initTip:function(){var t=F.context("user"),e="";a.on("mouseenter",function(){o("#category-select").length>0||(e=new i({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:"选择正确分类，问题才能得到更快解答",position:{my:"left top",at:"left bottom+5",using:function(t,e){o(this).css(t),o("<div>").addClass("tip-arrow").addClass("tip-arrow-"+e.vertical).html("<em></em><span></span>").appendTo(this)}}}),e.show())}).on("mouseleave",function(){e.close()}).on("click",function(){e.close()});var n="",c=258,l="";t.isLogin&&t.securemobil&&(n="手机号已绑定，有新回答时将收到免费短信提醒",c=270),t.isLogin&&""==t.securemobil&&(n="绑定手机号，有新回答时将收到免费短信提醒"),o("#phone-bar").on("mouseover",function(){l=new i({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:n,position:{my:"left top",at:"left bottom+10",using:function(t,e){o(this).css(t),o("<div>").addClass("tip-arrow").addClass("tip-arrow-"+e.vertical).html("<em></em><span></span>").appendTo(this)}}}),l.show()}).on("mouseout",function(){l.close()});var r="";o("#anonymous-bar").on("mouseover",function(){r=new i({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:"您可进行匿名提问，但需付出10财富值",position:{my:"left top",at:"left bottom+10",using:function(t,e){o(this).css(t),o("<div>").addClass("tip-arrow").addClass("tip-arrow-"+e.vertical).html("<em></em><span></span>").appendTo(this)}}}),r.show()}).on("mouseout",function(){r.close()}),o("#anonymous").on("click",function(){s.send({module:"new",page:"ask",area:"ask_normal_anonymous",action:"click"})}),o("#wealth-select").on("change",function(){s.send({module:"new",page:"ask",area:"ask_normal_weath",action:"click"})});var p="提高悬赏，更易吸引高手为您解答",u="";t.isLogin&&(p="您目前的财富值为"+F.context("wealth")+"，<p>提高悬赏，更易吸引高手为您解答</p>"),o("#wealth-bar").on("mouseover",function(){u=new i({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:p,position:{my:"left top",at:"left bottom+10",using:function(t,e){o(this).css(t),o("<div>").addClass("tip-arrow").addClass("tip-arrow-"+e.vertical).html("<em></em><span></span>").appendTo(this)}}}),u.show()}).on("mouseout",function(){u.close()}).on("click",function(){u.close()})}};o(function(){l.init()})});
;/*!new:widget/push-doctor/push-doctor.js*/
define("new:widget/push-doctor/push-doctor",function(e){function t(){o(),n("#doctor-phone").change(function(){n(this).val(this.checked?"1":"0")}),n("#doctor-btn").click(function(){d.send({module:"new",page:"ask",area:"doctor-submit",action:"click"}),c.fire("login.check",{isLogin:function(){i()}})})}function o(){n("#doctor-phone-bar a.change").click(function(){c.fire("phone.bind",{onSubmitSuccess:function(){setTimeout(function(){window.location.reload()},500)}})}),n("#doctor-phone-bar a.login").click(function(e){c.fire("login.check"),e.preventDefault()}),n("#doctor-age").on("click",function(){d.send({module:"new",page:"ask",area:"doctor_page_age",action:"click"})}),n(".doctor-sex").on("change",function(){d.send({module:"new",page:"ask",area:"doctor_page_sex",action:"click"})})}function i(){if(!n("#doctor-btn").attr("disabled")){var e={cm:100001,fr:"dc",activity_id:0,consult_tag:0,special_time:0,from_id:1562},t=n("input[name=doctor-sex]")[0],o=n("input[name=doctor-sex]")[1];if(t.checked?e.sex=1:o.checked?e.sex=2:"",void 0==e.sex||""==e.sex)return void a.alert("您还没有选择性别");if(""==n.trim(n("#doctor-age").val())||isNaN(n("#doctor-age").val()))return void a.alert("您还没有填写年龄，范围0-120岁");e.age=n.trim(n("#doctor-age").val()),e.sms=n("#doctor-phone").val();var i=r.filterTag(r.getContent()),s=/<img[^>]*src="(.+?)"[^>]*>/gi,l=i.match(s);e.desc_pics="";for(var u=0;null!=l&&u<l.length;u++)l[u]=l[u].replace(s,"$1"),e.desc_pics+=l[u]+",";if(e.description=n.trim(n("#title-area").val())+i.replace(/<[^>].*?>/g,""),n.string(e.description).getByteLength()/2<10)return void a.alert("请至少输入10个字");n("#doctor-btn").attr("disabled","true"),c.fire("editor.default");var g="//muzhi.baidu.com/doctor/openapi/zhidaoask?random="+Math.random();n.ajax({type:"POST",url:g,dataType:"jsonp",data:e,timeout:1e4,success:function(e){n("#doctor-btn").removeAttr("disabled"),d.send({type:2071,action:"submit-success",from_id:1562,source:"zhidao-change",qid:e.data.qid}),e&&0==e.errno?setTimeout(function(){location.href="http://muzhi.baidu.com/question/"+e.data.qid+".html"},500):a.alert("提问失败，请重试:(")},error:function(){n("#doctor-btn").removeAttr("disabled"),a.alert("网络出错，请重试:(")}})}}var n=e("common:widget/js/util/tangram/tangram"),c=e("common:widget/js/util/event/event"),c=(e("new:widget/js/ac/ac"),e("common:widget/js/util/store/store"),e("common:widget/js/util/event/event")),a=(e("new:widget/js/phone/phone"),e("common:widget/js/ui/dialog/dialog")),r=e("new:widget/js/editor/editor"),d=e("new:widget/js/log/log");e("common:widget/lib/jquery.placeholder/jquery.placeholder"),n(t)});
;/*!new:widget/push-mavin/push-mavin.js*/
define("new:widget/push-mavin/push-mavin",function(i){function n(i){return i.length>4?i.substr(0,4)+"...":i}function e(){var i=0,n=70;t("#wgt-push-mavin").delegate(".info","mouseenter",function(){t(this).find(".info-hover").animate({top:i})}).delegate(".info","mouseleave",function(){t(this).find(".info-hover").stop().css("top",n)}).delegate(".info","click",function(){t(this).find(".info-hover").stop().css("top",n);var i=window.open(),e=t(this).find("a").prop("href");setTimeout(function(){i.location=e},0)})}var t=i("common:widget/js/util/tangram/tangram"),a=(i("new:widget/js/ac/ac"),i("common:widget/js/util/event/event")),o=i("common:widget/lib/juicer/juicer"),m={862:{name:"基金",field:103102},159:{name:"保险",field:102},786:{name:"银行业务",field:101},164:{name:"个人理财",field:103}};o.register("truncate",n),a.on("mavin.push",function(i,n){m[n]?t.get("/mavin/api/getMavinList?field="+m[n].field,function(i){var n=t("#tpl-push-mavin").html();t("#wgt-push-mavin").html(o(n,{list:i.data.list,mavinNum:i.data.mavinNum})),a.fire("pgc.remove"),e(),t(".tag-guide")&&t(".tag-guide").hide()},"json"):t("#wgt-push-mavin").html("")})});
;/*!new:widget/push-pgc/push-pgc.js*/
define("new:widget/push-pgc/push-pgc",function(e){function t(){c(".wgt-push-pgc").delegate(".pgc-head","mouseenter",function(){c(".pgc-head-cover",this).animate({top:0})}).delegate(".pgc-head","mouseleave",function(){c(".pgc-head-cover",this).stop().css("top",g)}).delegate(".pgc-head","click",function(){var e=c(this).find("a").attr("purl");n.send({new_ui_pgc_view_click:1,cid1:i.pgcCid1}),window.open(e,"_blank")})}var c=e("common:widget/js/util/tangram/tangram"),n=(e("common:widget/js/util/event/event"),e("new:widget/js/log/log")),i=e("new:widget/js/pgc/pgc");e("common:widget/lib/jquery.placeholder/jquery.placeholder");var g=68;c(t)});
;/*!new:widget/push-zuoyebang/push-zuoyebang.js*/
define("new:widget/push-zuoyebang/push-zuoyebang",function(e){function t(){window.editor=l;var e=s("#tpl-push-zuoyebang").html(),t={};s(".wgt-push-zuoyebang").empty().html(a(e,t)),s(".push-zuoyebang-select").on("click",function(e){e.stopPropagation(),s(".push-zuoyebang-select-error").hide(),s(this).find("i").removeClass("i-arrow-down").addClass("i-arrow-up"),s(this).find(".push-zuoyebang-select-list").show()}),s(".push-zuoyebang-select-list").on("click",function(e){"A"==e.target.nodeName&&(s(this).hide(),s(this).parents(".push-zuoyebang-select").find("input").val(s(e.target).text()),s(this).parents(".push-zuoyebang-select").find("i").removeClass("i-arrow-up").addClass("i-arrow-down"),e.stopPropagation())}),s("body").on("click",function(){s(".wgt-push-zuoyebang i").removeClass("i-arrow-up").addClass("i-arrow-down"),s(".push-zuoyebang-select-list").hide()}),s("#zuobenag-btn").on("click",function(e){return e.stopPropagation(),n.fire("input.check"),u.error?(window.scrollTo(0,0),void s("#title-area").get(0).focus()):void n.fire("login.check",{isLogin:function(){i()},noLogin:function(){n.fire("login.log")}})})}function i(){return s(".push-zuoyebang-grade").removeClass("select-notnull"),s(".push-zuoyebang-subject").removeClass("select-notnull"),d.send({type:2015,ac:"click",pos:"submit-ask-zyb-allclick"}),""==s("#grade").val()?(s(".push-zuoyebang-grade").addClass("select-notnull"),s("#gradeError").show(),d.send({type:2015,ac:"click",pos:"submit-ask-zyb-grade"}),!1):""==s("#subject").val()?(s(".push-zuoyebang-subject").addClass("select-notnull"),s("#subjectError").show(),d.send({type:2015,ac:"click",pos:"submit-ask-zyb-subject"}),!1):void("其它"==s("#grade").val()||"其它"==s("#subject").val()?(d.send({type:2015,ac:"click",pos:"submit-ask-zyb-other"}),n.fire("submit.submit")):(n.fire("editor.default"),d.send({type:2015,ac:"click",pos:"submit-ask-zyb"}),o()))}function o(){var e={};e={query:F.context("query"),title:u.lastTitle,detail:l.filterTag(l.getContent()),cid:r.finalCid,isAuto:-r.userSelect,pid:"",anoy:s("#anonymous").get(0).checked?1:0,fix:s("#fix-uname").length?s("#fix-uname").attr("data-user"):"",fr:F.context("fr"),querytype:F.context("queryType"),psquery:F.context("psQuery"),rich:1,autofix:0,pushType:d.pushType,grade:s("#grade").val(),subject:s("#subject").val()};var t="http://zuoye.baidu.com/question/index.php/index/askzd";s.ajax({url:t,type:"POST",dataType:"jsonp",data:e,success:function(e){0==e.errNo?(c.remove("ik_new_asktitle"),c.remove("ik_new_askdetail"),c.remove("ik_new_asktitle_settime"),c.remove("ik_new_askdetail_settime"),setTimeout(function(){var t="http://zuoye.baidu.com/question/"+e.data.qid+".html";location.href=t},500)):1==e.errNo?n.fire("login.log",{onLoginSuccess:function(){o()}}):3==e.errNo&&(d.send({type:2015,ac:"click",pos:"submit-ask-zyb-fail"}),n.fire("submit.submit"))}})}var s=e("common:widget/js/util/tangram/tangram"),n=e("common:widget/js/util/event/event"),a=e("common:widget/lib/juicer/juicer"),u=e("new:widget/js/input/input"),r=e("new:widget/js/ac/ac"),c=e("common:widget/js/util/store/store"),l=e("new:widget/js/editor/editor"),n=e("common:widget/js/util/event/event"),d=e("new:widget/js/log/log");e("common:widget/lib/jquery.placeholder/jquery.placeholder");s("#zuobenag-submit-btn").on("click",function(){d.send({type:2015,ac:"click",pos:"submit-ask-zhidao"}),n.fire("submit.submit")}),s(t)});
;/*!new:widget/submit/submit.js*/
define("new:widget/submit/submit",function(t){var i=T=t("common:widget/js/util/tangram/tangram"),e=t("common:widget/js/util/event/event"),n=t("common:widget/js/util/store/store"),o=t("new:widget/js/submit/submit"),a=(t("new:widget/js/pgc/pgc"),t("new:widget/js/log/log")),s=t("new:widget/js/ac/ac"),r=(t("common:widget/js/ui/dialog/dialog"),t("new:widget/js/editor/editor")),u=(t("common:widget/lib/juicer/juicer"),t("common:widget/js/logic/login/login"),t("new:widget/js/input/input")),c=t("new:widget/js/string/string");T("#submit-btn").on("click",function(t){t.stopPropagation();var n=this,r=T("#title-area");n.errorTip=T("#title-error-tip"),c.getLength(r)<10?n.errorTip.html(u.errorInfo.short||"").show():n.errorTip.html("").hide(),i(this).hasClass("disabled")||(o.pgcSubmit=!1,T(this).attr("data-sub")||(a.send({module:"ask-sample",page:"ask",action:"click",area:"submit-btn"}),T(this).attr("data-sub","1"),setTimeout(function(){T("#submit-btn").removeAttr("data-sub")},2e3),e.fire("ac.send",{callback:function(){e.fire("input.quality",{pushTotal:0,pushData:[]}),"1"===F.context("user").isRealName?e.fire("login.realName",{onSubmitSuccess:function(){e.fire("submit.submit")}}):e.fire("submit.submit")},failure:function(){s.ready()}})))}),T(".submit-btn-nologin").on("click",function(t){t.stopPropagation(),e.fire("ac.send",{callback:function(){e.fire("input.quality",{pushTotal:0,pushData:[]}),e.fire("submit.submit",{noLoginFlag:!0})},failure:function(){s.ready()}})}),T("#look-btn").on("click",function(t){t.stopPropagation(),e.fire("submit.pushchange",{type:"continue"}),a.lookBtnClick=1,a.send({new_ui_look_btn_click:1})}),T("#over-btn").on("click",function(t){t.stopPropagation(),n.remove("ik_new_asktitle"),n.remove("ik_new_askdetail"),n.remove("ik_new_askimg"),n.remove("ik_new_asktitle_settime"),n.remove("ik_new_askdetail_settime"),a.send({new_ui_over_btn_click:1}),location.href="http://zhidao.baidu.com"}),window.onbeforeunload=function(){a.errorType&&a.send({type:2014,isLook:a.lookBtnClick,title:encodeURIComponent(T("#title-area").val()),rich:encodeURIComponent(T.string(r.getContent()).trim()),errorType:a.errorType})}});
;/*!new:widget/tag/tag.js*/
define("new:widget/tag/tag",function(t,a,g){var n=(t("common:widget/js/util/tangram/tangram"),t("new:widget/js/tag/tag"));g.exports=n.init()});
;/*!new:widget/title/title.js*/
define("new:widget/title/title",function(t){var e=t("common:widget/js/util/tangram/tangram"),i=t("common:widget/js/util/event/event"),n=t("common:widget/js/util/store/store"),a=t("common:widget/js/util/uri/uri"),s=t("common:widget/js/ui/dialog/dialog"),o=t("common:widget/js/ui/tip/tip"),l=t("new:widget/js/editor/editor"),c=(t("new:widget/js/input/input"),t("new:widget/js/ac/ac")),d=t("new:widget/js/authcode/authcode"),r=t("new:widget/js/lbs/lbs"),u=t("new:widget/js/log/log"),p=e("#title-area"),f={init:function(){p.on("focus",function(){e(this).addClass("focus"),d.init()}).on("blur",function(){e(this).removeClass("focus"),i.fire("input.sub",{}),c.ready(),r.ready()}).on("keyup",function(){i.fire("input.sub",{}),c.ready(),r.ready(),n.set("ik_new_asktitle",e.string(p.val()).trim()),n.set("ik_new_asktitle_settime",(new Date).getTime())}).on("keydown",function(){c.cancel(),r.cancel()}).on("click",function(){i.fire("input.sub",{}),c.ready(),r.ready()}),this._focusEnd(),this._titleAutoHeight(),this._onlineInfoUpdate()},_focusEnd:function(){var t=p.get(0);t.focus();var e=t.value.length;if(document.selection){var i=t.createTextRange();i.moveStart("character",e),i.collapse(),i.select()}else"number"==typeof t.selectionStart&&"number"==typeof t.selectionEnd&&(t.selectionStart=t.selectionEnd=e)},_titleAutoHeight:function(){function t(){function t(){i.style.height=F.context("zhimaTagOpen")&&F.context("zhimaTagOpen").open?Math.max(n.scrollHeight,25)+"px":Math.max(n.scrollHeight,20)+"px"}n.value=i.value,t(),setTimeout(t,0)}var i=p.get(0),n=e("#title-area-shadow").get(0);i.oninput=i.onpropertychange=t},_onlineInfoUpdate:function(){var t=e("#online-info").find("span");setInterval(function(){t.each(function(){var t=parseInt(e(this).html()),i=Math.ceil(10*Math.random());t+=Math.random()>.5?i:-i,isNaN(t)||e(this).html(t)})},1e4)}},g={init:function(){this._initPic(),this._initLbs(),this._initEvent()},_initPic:function(){var t,i,n;e("#ask-editor .edui-for-insertimage").mouseover(function(a){a.stopPropagation(),e(this).find(".edui-label-overflow").length>0?(i="图片上传数量达到限制",n=140):(i=F.context("user").isLogin?"插入图片":"登录后才能插入图片",n=F.context("user").isLogin?70:130),t=new o({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:i,position:{my:"left top",at:"left bottom",using:function(t,i){e(this).css(t),e("<div>").addClass("tip-arrow").addClass("tip-arrow-"+i.vertical).html("<em></em><span></span>").appendTo(this)}}}),t.show()}).mouseout(function(e){e.stopPropagation(),t.close()})},_initLbs:function(){var t,n=e("<div>"),l=['<i class="i-insert-place"></i><span class="insert-place-label" id="address-label">地点</span>','<span class="address-info" id="address-info" style="display:none;">','关于<span class="address-value f-blue" id="address-value" data-flag="0"></span>的问题','<i class="i-del-place" id="address-delete"></i>',"</span>"].join("");n.addClass("insert-place").appendTo("#ask-editor .edui-toolbar").html(l).mouseover(function(i){i.stopPropagation(),n.addClass("insert-place-hover");e.browser.ie<7?[0,-2]:[0,-10];""==n.find("#address-value").html()&&(t=new o({target:this,tooltipClass:"tip-black tip-radius tip-shadow",content:"插入地点标签，有助于让熟悉该地点的人为您解答",position:{my:"left top",at:"left bottom",using:function(t,i){e(this).css(t),e("<div>").addClass("tip-arrow").addClass("tip-arrow-"+i.vertical).html("<em></em><span></span>").appendTo(this)}}}),t.show())}).mouseout(function(e){e.stopPropagation(),n.removeClass("insert-place-hover"),""==n.find("#address-value").html()&&t&&t.close()}).click(function(){function t(){var t=r.finalAddress,i=r.finalCity,n=r.finalLng,o=r.finalLat,l=r.flag,c="?address="+encodeURI(t)+"&city="+encodeURI(i)+"&lng="+n+"&lat="+o+"&flag="+l;new s.iframe({title:"",content:a.addmapAddress+c,width:e.ie?762:742,height:e.ie?520:500,draggable:!1})}var n=r.finalLng,o=r.finalLat;""==n&&""==o||0==n&&0==o?i.fire("lbs.send",{callback:function(){t()}}):t()})},_initEvent:function(){e(l.instance.document).on("keyup",function(){c.ready(),n.set("ik_new_askdetail",e.string(l.getContentTxt()).trim()),n.set("ik_new_askdetail_settime",(new Date).getTime())}).on("keydown",function(){c.cancel()}).on("click",function(){c.ready()}).on("blur",function(){c.ready()})}};e(function(){g.init(),f.init(),e(".ask-rule").on("click",function(){u.send({module:"new",page:"ask",area:"ask-rule",action:"click"})}),u.send({module:"new",page:"ask",area:"page-pv",action:"pv"})})});